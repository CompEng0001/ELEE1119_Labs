<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>PinExploration - Advanced Computer Engineering</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><li class="spacer"></li><li class="chapter-item affix "><li class="spacer"></li><li class="chapter-item "><a href="../Introduction/Introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item affix "><li class="spacer"></li><li class="chapter-item affix "><li class="spacer"></li><li class="chapter-item affix "><li class="part-title">Debian Rock C4</li><li class="chapter-item "><a href="../Debian_Rock/Debian_Rock.html"><strong aria-hidden="true">2.</strong> Debian Rock C4</a></li><li class="chapter-item "><a href="../tmux/tmux.html"><strong aria-hidden="true">3.</strong> Terminal Multiplexing</a></li><li class="chapter-item "><a href="../vim/vim.html"><strong aria-hidden="true">4.</strong> vim</a></li><li class="chapter-item "><div><strong aria-hidden="true">5.</strong> Fork Bomb</div></li><li class="chapter-item "><div><strong aria-hidden="true">6.</strong> Multi-Threading 1</div></li><li class="chapter-item "><div><strong aria-hidden="true">7.</strong> Multi-Threading 2</div></li><li class="chapter-item "><div><strong aria-hidden="true">8.</strong> System Calls</div></li><li class="chapter-item "><div><strong aria-hidden="true">9.</strong> Daemons</div></li><li class="chapter-item "><div><strong aria-hidden="true">10.</strong> UUID</div></li><li class="chapter-item affix "><li class="spacer"></li><li class="chapter-item affix "><li class="spacer"></li><li class="chapter-item affix "><li class="part-title">BeagleBoard</li><li class="chapter-item "><a href="../ChipExploration/ChipExploration.html"><strong aria-hidden="true">11.</strong> Exploring the Chips</a></li><li class="chapter-item expanded "><a href="../PinExploration/PinExploration.html" class="active"><strong aria-hidden="true">12.</strong> PinExploration</a></li><li class="chapter-item "><a href="../GPIOLibrary/GPIOLibrary.html"><strong aria-hidden="true">13.</strong> GPIO C Library</a></li><li class="chapter-item "><a href="../ADCLibrary/ADCLibrary.html"><strong aria-hidden="true">14.</strong> ADC C Library</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../ADCLibrary/ADCContinous.html"><strong aria-hidden="true">14.1.</strong> ADC Continous </a></li></ol></li><li class="chapter-item "><a href="../PWMLibrary/PWMLibrary.html"><strong aria-hidden="true">15.</strong> PWM C Library</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../PWMLibrary/ADCtoPWM.html"><strong aria-hidden="true">15.1.</strong> ADC to PWM Library</a></li></ol></li><li class="chapter-item "><div><strong aria-hidden="true">16.</strong> libioctrl</div></li><li class="chapter-item "><div><strong aria-hidden="true">17.</strong> USB Ethernet</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><div><strong aria-hidden="true">17.1.</strong> USB to Ethernet sniffing tool</div></li></ol></li><li class="chapter-item "><div><strong aria-hidden="true">18.</strong> Mounting an SD</div></li><li class="chapter-item affix "><li class="spacer"></li><li class="chapter-item affix "><li class="spacer"></li><li class="chapter-item affix "><li class="part-title">C</li><li class="chapter-item "><div><strong aria-hidden="true">19.</strong> Learning C</div></li><li class="chapter-item "><div><strong aria-hidden="true">20.</strong> Programming Computers</div></li><li class="chapter-item affix "><li class="spacer"></li><li class="chapter-item affix "><li class="spacer"></li><li class="chapter-item affix "><li class="part-title">Rust</li><li class="chapter-item "><div><strong aria-hidden="true">21.</strong> Intro to Rust</div></li><li class="chapter-item affix "><li class="spacer"></li><li class="chapter-item affix "><li class="spacer"></li><li class="chapter-item affix "><li class="part-title">Bourne Again SHell</li><li class="chapter-item "><a href="../Redirection/Redirection.html"><strong aria-hidden="true">22.</strong> Redirection</a></li><li class="chapter-item "><a href="../Bash/Bash_Scripting.html"><strong aria-hidden="true">23.</strong> Bash</a></li><li class="chapter-item "><a href="../ManPages/ManPages.html"><strong aria-hidden="true">24.</strong> Man Pages</a></li><li class="chapter-item "><a href="../SystemsStats/SystemsStats.html"><strong aria-hidden="true">25.</strong> Systems Stats Script</a></li><li class="chapter-item "><a href="../RFC_Logger/rfclogger.html"><strong aria-hidden="true">26.</strong> RFC Logger</a></li><li class="chapter-item affix "><li class="spacer"></li><li class="chapter-item affix "><li class="spacer"></li><li class="chapter-item affix "><li class="part-title">Git</li><li class="chapter-item "><a href="../myFirstRepository/myFirstRepository.html"><strong aria-hidden="true">27.</strong> My First Repository</a></li><li class="chapter-item "><a href="../BranchingModel/BranchingModel.html"><strong aria-hidden="true">28.</strong> Branching-Strategy</a></li><li class="chapter-item "><a href="../OneFlow/OneFlow.html"><strong aria-hidden="true">29.</strong> Git Oneflow</a></li><li class="chapter-item "><a href="../AntiPatterns/AntiPatterns.html"><strong aria-hidden="true">30.</strong> Anti Patterns</a></li><li class="chapter-item "><a href="../ContinousDeployment/ContinousDeployment.html"><strong aria-hidden="true">31.</strong> Continous Deployment</a></li><li class="chapter-item "><a href="../ReleaseDeployment/ReleaseDeployment.html"><strong aria-hidden="true">32.</strong> Release Deployment</a></li><li class="chapter-item "><a href="../Migration/Migration.html"><strong aria-hidden="true">33.</strong> Migration</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Advanced Computer Engineering</h1>

                    <div class="right-buttons">

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="pin-exploration"><a class="header" href="#pin-exploration">Pin Exploration</a></h1>
<h2 id="understanding-beagleboard-gpio-pin-mapping-and-device-tree-setup"><a class="header" href="#understanding-beagleboard-gpio-pin-mapping-and-device-tree-setup">Understanding BeagleBoard GPIO Pin Mapping and Device Tree Setup</a></h2>
<p>To understand how the BeagleBoard sets up pin mappings using Device Tree Source files (.dts) and calculates the correct GPIO number (<code>gpioXXX</code>) under <code>/sys/class/gpio</code>, let's break down the process step-by-step:</p>
<h3 id="1-device-tree-source-dts-files"><a class="header" href="#1-device-tree-source-dts-files">1. Device Tree Source (.dts) Files</a></h3>
<p>The BeagleBoard uses Device Tree Source (.dts) files to describe its hardware layout and configuration. These files are compiled into Device Tree Blobs (.dtb), which the Linux kernel reads at boot time to understand the hardware setup.</p>
<p>A <code>.dts</code> file contains descriptions of the board's hardware components, including processors, memory, peripherals, and importantly, the General Purpose Input/Output (GPIO) pins.</p>
<h3 id="2-pin-multiplexing-and-pin-control"><a class="header" href="#2-pin-multiplexing-and-pin-control">2. Pin Multiplexing and Pin Control</a></h3>
<p><strong>Pin multiplexing</strong> allows a single physical pin on a processor to serve multiple functions, depending on the configuration. The <code>.dts</code> file defines how each pin on the BeagleBoard is multiplexed:</p>
<pre><code class="language-dts">pinctrl-name = "default";
pinctrl-0 = &lt;&amp;my_pins&gt;;

my_pins: pinmux_my_pins {
    pinctrl-single,pins = &lt;
        0x034 (PIN_OUTPUT | MUX_MODE7)  /* Pin X configuration */
        0x038 (PIN_INPUT | MUX_MODE7)   /* Pin Y configuration */
    &gt;;
};
</code></pre>
<p>In this example:</p>
<ul>
<li><code>0x034</code> and <code>0x038</code> are addresses in the pin control register.</li>
<li><code>PIN_OUTPUT | MUX_MODE7</code> and <code>PIN_INPUT | MUX_MODE7</code> specify the pin's mode and direction.</li>
<li>Overlays can be found here for the BB -&gt; <a href="https://github.com/pmunts/muntsos/tree/master/boot/BeagleBone/overlays">https://github.com/pmunts/muntsos/tree/master/boot/BeagleBone/overlays</a></li>
</ul>
<h4 id="21-understanding-beagleboard-dts-file-configuration-for-gpio-pin"><a class="header" href="#21-understanding-beagleboard-dts-file-configuration-for-gpio-pin">2.1 Understanding BeagleBoard DTS File Configuration for GPIO Pin</a></h4>
<p>In a BeagleBoard Device Tree Source (.dts) file, pin configurations are defined using specific properties that control how each pin operates. Let’s break down the following example to understand what it does:</p>
<pre><code class="language-dts">8_11_gpio_input_pin: pinmux_P8_11_gpio_input_pin { 
    pinctrl-single,pins = &lt;
        ((((0x0834)) &amp; 0xffff) - (0x0800)) (((1 &lt;&lt; 5) | (1 &lt;&lt; 3)) | 7) 
    &gt;; 
};
</code></pre>
<h4 id="22-explanation-of-each-part"><a class="header" href="#22-explanation-of-each-part">2.2 Explanation of Each Part</a></h4>
<ol>
<li>
<p><strong>Label (<code>8_11_gpio_input_pin</code>) and Node Name (<code>pinmux_P8_11_gpio_input_pin</code>)</strong>:</p>
<ul>
<li><code>8_11_gpio_input_pin:</code> is a label that can be referenced elsewhere in the device tree.</li>
<li><code>pinmux_P8_11_gpio_input_pin</code> is the name of this pin configuration node.</li>
</ul>
</li>
<li>
<p><strong><code>pinctrl-single,pins</code> Property</strong>:</p>
<ul>
<li>This property defines a list of pin configuration settings for the pins controlled by the <code>pinctrl-single</code> driver. The syntax follows the specific format needed to define the pin's multiplexing and electrical settings.</li>
</ul>
</li>
<li>
<p><strong>Pin Configuration Value</strong>:</p>
<ul>
<li>The value within the <code>pinctrl-single,pins</code> property is given as a tuple of two values: the register offset and the value to be written to that register.</li>
</ul>
<pre><code class="language-dts">((((0x0834)) &amp; 0xffff) - (0x0800)) (((1 &lt;&lt; 5) | (1 &lt;&lt; 3)) | 7)
</code></pre>
<p>This is split into two main parts:</p>
<ul>
<li><strong>Register Offset Calculation</strong>: <code>((((0x0834)) &amp; 0xffff) - (0x0800))</code></li>
<li><strong>Pin Configuration Value</strong>: <code>(((1 &lt;&lt; 5) | (1 &lt;&lt; 3)) | 7)</code></li>
</ul>
</li>
</ol>
<p>Let's explain these parts in detail:</p>
<h4 id="23-register-offset-calculation"><a class="header" href="#23-register-offset-calculation">2.3 Register Offset Calculation</a></h4>
<pre><code class="language-dts">((((0x0834)) &amp; 0xffff) - (0x0800))
</code></pre>
<ul>
<li>
<p><strong><code>0x0834</code></strong>: This is the address in the memory-mapped I/O space for the pin's configuration register. It's where the pin configuration settings will be applied.</p>
</li>
<li>
<p><strong><code>0xffff</code></strong>: This mask ensures that only the lower 16 bits of the address are considered, which aligns with the hardware addressing limitations.</p>
</li>
<li>
<p><strong>Bitwise AND (<code>&amp;</code>)</strong>: <code>((0x0834) &amp; 0xffff)</code> masks the address to retain only the lower 16 bits.</p>
</li>
<li>
<p><strong>Subtracting <code>0x0800</code></strong>: <code>- (0x0800)</code> adjusts the base address. The <code>pinctrl-single</code> driver expects register offsets to be zero-based relative to a certain base address (often <code>0x0800</code>), so this calculation normalizes the address to start from zero.</p>
<p>Thus, <code>((((0x0834)) &amp; 0xffff) - (0x0800))</code> computes the zero-based offset for the pin configuration register in the <code>pinctrl-single</code> driver's address space.</p>
</li>
</ul>
<h4 id="24-pin-configuration-value"><a class="header" href="#24-pin-configuration-value">2.4 Pin Configuration Value</a></h4>
<pre><code class="language-dts">(((1 &lt;&lt; 5) | (1 &lt;&lt; 3)) | 7)
</code></pre>
<ul>
<li>
<p><strong><code>1 &lt;&lt; 5</code></strong>: This shifts the binary <code>1</code> five bits to the left, resulting in the binary value <code>0b100000</code> or <code>0x20</code>.</p>
</li>
<li>
<p><strong><code>1 &lt;&lt; 3</code></strong>: This shifts the binary <code>1</code> three bits to the left, resulting in the binary value <code>0b1000</code> or <code>0x08</code>.</p>
</li>
<li>
<p><strong>Bitwise OR (<code>|</code>)</strong>: <code>(1 &lt;&lt; 5) | (1 &lt;&lt; 3)</code> combines these two binary values using a bitwise OR, resulting in <code>0b101000</code> or <code>0x28</code>.</p>
</li>
<li>
<p><strong><code>| 7</code></strong>: This further modifies the configuration by applying another OR operation with <code>7</code> (<code>0b111</code>), resulting in <code>0b101111</code> or <code>0x2F</code>.</p>
</li>
</ul>
<h4 id="25-what-does-the-configuration-value-do"><a class="header" href="#25-what-does-the-configuration-value-do">2.5 What Does the Configuration Value Do?</a></h4>
<p>The final configuration value, <code>0x2F</code>, encodes multiple pin settings:</p>
<ul>
<li><strong>Direction</strong>: GPIO pins can be configured as input or output.</li>
<li><strong>Pull-up/Pull-down resistors</strong>: Determines if internal resistors are enabled.</li>
<li><strong>Mode Selection</strong>: This determines which function the pin will perform (GPIO, UART, I2C, etc.).</li>
</ul>
<p>In this context, the value <code>0x2F</code> could represent a specific configuration for the pin, such as setting it to GPIO mode, enabling input, and possibly enabling pull-up resistors. The exact meaning would depend on the specific configuration bits defined in the processor's datasheet or reference manual.</p>
<h3 id="3-gpio-pin-naming-convention-gpiox_yy"><a class="header" href="#3-gpio-pin-naming-convention-gpiox_yy">3. GPIO Pin Naming Convention (GPIOX_YY)</a></h3>
<p>Each GPIO pin on a BeagleBoard has a naming convention:</p>
<ul>
<li><code>GPIOX_YY</code>, where:
<ul>
<li><code>X</code> is the GPIO bank number.</li>
<li><code>YY</code> is the pin number within that bank.</li>
</ul>
</li>
</ul>
<p>For example, <code>GPIO2_13</code> means:</p>
<ul>
<li>It’s the 13th pin (0-based, so it's the 14th physical pin) of GPIO bank 2.</li>
</ul>
<h3 id="4-calculating-the-correct-gpio-number-gpioxxx-in-sysclassgpio"><a class="header" href="#4-calculating-the-correct-gpio-number-gpioxxx-in-sysclassgpio">4. Calculating the Correct GPIO Number (<code>gpioXXX</code>) in <code>/sys/class/gpio</code></a></h3>
<p>To interact with GPIOs in Linux, you use the <code>/sys/class/gpio</code> interface, which requires a global GPIO number (gpioXXX), calculated as:</p>
<p>\[gpioXXX = ( x \cdot 32 ) + yy\]</p>
<p>Where:</p>
<ul>
<li>\(x\) is the GPIO bank number.</li>
<li>\(yy\) is the pin number within the bank.</li>
</ul>
<p>Example Calculation:</p>
<p>For <code>GPIO2_13</code>:</p>
<ul>
<li>\(x = 2\)</li>
<li>\(yy = 13\)</li>
</ul>
<p>The global GPIO number is:</p>
<p>\[gpioXXX = ( 2 \cdot 32 ) + 13 = 64 + 13 = 77\]</p>
<p>So, <code>GPIO2_13</code> corresponds to <code>gpio77</code>.</p>
<h3 id="5-mapping-the-gpio-pins-to-the-p89-pins"><a class="header" href="#5-mapping-the-gpio-pins-to-the-p89-pins">5. Mapping the gpio pins to the P8/9 pins</a></h3>
<ol>
<li>
<p><strong>What is <code>/sys/class/gpio?</code></strong></p>
<p><code>/sys/class/gpio</code> is a part of the sysfs filesystem in Linux, which provides a user-space interface to interact with GPIO (General Purpose Input/Output) pins. GPIO pins are commonly used in embedded systems, like the BeagleBoard, to interface with external hardware (sensors, LEDs, buttons, etc.).</p>
<p>The <code>/sys/class/gpio</code> directory contains subdirectories and files that represent each GPIO pin controlled by the Linux kernel. Through this interface, you can:</p>
<ul>
<li><strong>Export</strong> GPIO pins to user space for direct control.</li>
<li><strong>Set the direction</strong> (input or output) of GPIO pins.</li>
<li><strong>Read</strong> from or write to GPIO pins.</li>
</ul>
<p>Each GPIO pin that is controlled by the kernel is represented by a directory named gpioXXX, where XXX is the GPIO number.</p>
<p>You can access the (gpioX) pins label to map the /sys/class/gpio/gpio to the breackout pin:</p>
<pre><code class="language-sh">$ cat /sys/class/gpio/gpio115/label
&gt; P9_27
</code></pre>
</li>
<li>
<p><strong>Build map for the GPIO and Lable</strong></p>
<p>The provided Bash script is designed to create a CSV file <code>(gpio_map.csv</code>) that maps each GPIO number to its label. Here is what each part of the script does:</p>
<pre><code class="language-sh">#!/usr/bin/env bash
echo "GPIO,Label" &gt; gpio_map.csv
for gpio in /sys/class/gpio/gpio*; do
    gpio_num=$(basename "$gpio")
    label=$(cat "$gpio/label")
    echo "$gpio_num,$label" &gt;&gt; gpio_map.csv
done
</code></pre>
<p>Run the following now to see the map:</p>
<pre><code class="language-sh">$ cat gpio_map.csv
&gt; 
GPIO,Label
gpio10,P8_31
gpio11,P8_32
gpio110,P9_31
gpio111,P9_29
gpio112,P9_30
gpio113,P9_28
gpio114,P9_92
gpio115,sysfs
gpio116,P9_91
gpio117,P9_25
gpio12,P9_20
gpio13,P9_19
gpio14,P9_26
gpio15,P9_24
...
</code></pre>
</li>
</ol>
<h3 id="6-understanding-config-pin-and-the-importance-of-knowing-pin-modes"><a class="header" href="#6-understanding-config-pin-and-the-importance-of-knowing-pin-modes">6. Understanding config-pin and the Importance of Knowing Pin Modes</a></h3>
<ol>
<li>
<p><strong>What is config-pin?</strong></p>
<p><code>config-pin</code> is a command-line utility used on BeagleBoard (like BeagleBone Black) to configure the pin modes of the GPIO (General Purpose Input/Output) pins. The BeagleBoard has multiple headers (P8 and P9) with several pins that can serve various functions depending on their configuration.</p>
<p>The config-pin tool allows you to change the function of a specific pin on the fly without needing to modify or recompile the device tree files (.dts). This tool is part of the bb-cape-overlays package and provides a straightforward way to set a pin’s mode dynamically.</p>
</li>
<li>
<p><strong>Why Do We Need to Know Pin Modes?</strong></p>
<p>Each pin on the BeagleBoard is multipurpose and can be configured to operate in different modes. These modes determine the function of the pin, such as:</p>
<ul>
<li><strong>GPIO (General Purpose Input/Output)</strong>: The pin can be used as a digital input or output, can pull up or pull down.</li>
<li><strong>UART (Universal Asynchronous Receiver/Transmitter)</strong>: The pin can be used for serial communication.</li>
<li><strong>I2C (Inter-Integrated Circuit)</strong>: The pin can be used for I2C communication.</li>
<li><strong>SPI (Serial Peripheral Interface)</strong>: The pin can be used for SPI communication.</li>
<li><strong>PWM (Pulse Width Modulation)</strong>: The pin can be used to output PWM signals.</li>
<li><strong>Analog Input</strong>: The pin can be used to read analog voltage levels.</li>
</ul>
<p>Knowing the available modes for each pin is essential because:</p>
<ul>
<li>
<p><strong>Correct Hardware Configuration</strong>: To connect external hardware (like sensors, LEDs, or communication modules), you must set the pins to the correct mode. For example, if you're connecting a UART device, the pins must be in UART mode.</p>
</li>
<li>
<p><strong>Avoiding Conflicts</strong>: Certain peripherals or external devices require exclusive use of specific pins. If the pins are not correctly configured, there could be conflicts leading to hardware malfunction or communication errors.</p>
</li>
<li>
<p><strong>Optimal Use of Resources</strong>: Understanding pin modes helps you make the most of the available hardware resources. The BeagleBoard has limited pins, and each can serve multiple roles. Correctly configuring them allows you to maximize functionality.</p>
</li>
<li>
<p><strong>Flexibility in Development</strong>: Knowing how to use config-pin to change modes enables flexibility during development and testing. You can quickly reconfigure pins for different functions without needing to reboot or recompile.</p>
</li>
</ul>
</li>
<li>
<p><strong>How to Use config-pin</strong>:</p>
<p>The config-pin tool syntax is straightforward. Here’s how you use it:</p>
<ol>
<li>
<p>Check Available Modes for a Pin:</p>
<p>To see what modes are available for a specific pin:</p>
<pre><code class="language-sh">config-pin -l &lt;pin&gt;
</code></pre>
<p>Example:</p>
<pre><code class="language-sh">$ config-pin -l P9.12
&gt; Available modes for P9_12 are: default gpio gpio_pu gpio_pd gpio_input
</code></pre>
</li>
<li>
<p>Current configured mode:</p>
<pre><code class="language-sh">config-pin -q &lt;pin&gt;
</code></pre>
<p>Example:</p>
<pre><code class="language-sh">$ config-pin -q P9.12
&gt; Current mode for P9_12 is:     default
</code></pre>
</li>
<li>
<p>To check all configurations we can write a script:</p>
 <details>
 <summary>Suppressed code here [52 lines] ... </summary>
<pre><code class="language-sh">#!/usr/bin/env bash

# Output file
OUTPUT_FILE="pin_config_report.txt"

# List of all pins on P8 and P9 headers (BeagleBone Black)
PINS=(
    P8_3 P8_4 P8_5 P8_6 P8_7 P8_8 P8_9 P8_10
    P8_11 P8_12 P8_13 P8_14 P8_15 P8_16 P8_17 P8_18
    P8_19 P8_20 P8_21 P8_22 P8_23 P8_24 P8_25 P8_26
    P8_27 P8_28 P8_29 P8_30 P8_31 P8_32 P8_33 P8_34
    P8_35 P8_36 P8_37 P8_38 P8_39 P8_40 P8_41 P8_42
    P8_43 P8_44 P8_45 P8_46
    P9_11 P9_12 P9_13 P9_14 P9_15 P9_16 P9_17 P9_18
    P9_19 P9_20 P9_21 P9_22 P9_23 P9_24 P9_25 P9_26
    P9_27 P9_28 P9_29 P9_30 P9_31 P9_41 P9_42 P9_92
    P9_93
)
# Clear or create the output file and add the header
echo "Pin     | Current Mode       | Available Modes" &gt; "$OUTPUT_FILE"
echo "-----------------------------------------------" &gt;&gt; "$OUTPUT_FILE"

# Iterate over each pin and get its current and possible configurations
for PIN in "${PINS[@]}"; do
    echo "Checking configuration for $PIN..."

    # Capture the output of config-pin command
    CURRENT_MODE_OUTPUT=$(config-pin -q "$PIN" 2&gt;&amp;1)

    # Check if the output contains "open()"
    if [[ "$CURRENT_MODE_OUTPUT" == *"open()"* ]]; then
        CURRENT_MODE="-"
    else
        CURRENT_MODE=$(echo "$CURRENT_MODE_OUTPUT" | awk -F': ' '{print $2}' | xargs)
    fi

    # Capture the output of possible modes
    POSSIBLE_MODES_OUTPUT=$(config-pin -l "$PIN" 2&gt;&amp;1)

    # Check if the output contains "open()"
    if [[ "$POSSIBLE_MODES_OUTPUT" == *"open()"* ]]; then
        POSSIBLE_MODES="-"
    else
        POSSIBLE_MODES=$(echo "$POSSIBLE_MODES_OUTPUT" | tr -d '\n' | awk -F ':' '{print$2}' | xargs)
    fi

    # Write results to output file with formatted columns
    printf "%-7s | %-18s | %s\n" "$PIN" "$CURRENT_MODE" "$POSSIBLE_MODES" &gt;&gt; "$OUTPUT_FILE"
done

echo "Pin configuration report saved to $OUTPUT_FILE"
</code></pre>
 </details>
</li>
<li>
<p>Run the following to see the report:</p>
<pre><code class="language-sh">$ less pin_config_report.txt
</code></pre>
 <details>
 <summary>This is the output...</summary>
<pre><code>Pin     | Current Mode       | Available Modes
-----------------------------------------------
P8_3    | -                  | -
P8_4    | -                  | -
P8_5    | -                  | -
P8_6    | -                  | -
P8_7    | -                  | -
P8_8    | -                  | -
P8_9    | -                  | -
P8_10   | default            | default gpio gpio_pu gpio_pd gpio_input timer
P8_11   | default            | default gpio gpio_pu gpio_pd gpio_input qep pruout
P8_12   | default            | default gpio gpio_pu gpio_pd gpio_input qep pruout
P8_13   | default            | default gpio gpio_pu gpio_pd gpio_input pwm
P8_14   | default            | default gpio gpio_pu gpio_pd gpio_input pwm
P8_15   | default            | default gpio gpio_pu gpio_pd gpio_input qep pru_ecap pruin
P8_16   | default            | default gpio gpio_pu gpio_pd gpio_input qep pruin
P8_17   | default            | default gpio gpio_pu gpio_pd gpio_input pwm
P8_18   | default            | default gpio gpio_pu gpio_pd gpio_input
P8_19   | default            | default gpio gpio_pu gpio_pd gpio_input pwm
P8_20   | -                  | default gpio gpio_pu gpio_pd gpio_input pruout pruin
P8_21   | -                  | default gpio gpio_pu gpio_pd gpio_input pruout pruin
...
</code></pre>
 </details>
</li>
<li>
<p>Set a Pin Mode:</p>
<p>``sh
config-pin <pin> <mode></p>
<pre><code>
Example:

```sh
config-pin P9.12 uart
</code></pre>
<p>This command sets pin P9.12 to UART mode.</p>
</li>
<li>
<p>Verify current pins</p>
<pre><code class="language-sh">config-pin -q &lt;pin&gt;
</code></pre>
</li>
</ol>
<blockquote>
<p><strong>Note:</strong></p>
<blockquote>
<ul>
<li>Any pins you have set manually to do not presist across power cycling.</li>
<li>You could write a script that configures all the pins after boot, after the kernel has pre-loaded maps.</li>
<li>Alternatively you could make your own <code>.dts</code>!</li>
</ul>
</blockquote>
</blockquote>
</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../ChipExploration/ChipExploration.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../GPIOLibrary/GPIOLibrary.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../ChipExploration/ChipExploration.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../GPIOLibrary/GPIOLibrary.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
